# ğŸ­ Parrot Engine - è™šæ‹Ÿæ•°å­—äººå¼•æ“

**Parrot Engine** æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Python è™šæ‹Ÿæ•°å­—äººç³»ç»Ÿï¼Œé›†æˆäº† Live2D æ¨¡å‹æ¸²æŸ“ã€è¯­éŸ³è¯†åˆ«ã€æ–‡æœ¬è½¬è¯­éŸ³ã€å¤§è¯­è¨€æ¨¡å‹å¯¹è¯å’Œå®æ—¶æ¨æµç­‰åŠŸèƒ½ï¼Œæ‰“é€ æ²‰æµ¸å¼çš„æ•°å­—äººäº¤äº’ä½“éªŒã€‚

![Python](https://img.shields.io/badge/Python-3.9+-blue.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Live2D](https://img.shields.io/badge/Live2D-Hiyori-pink.svg)
![Status](https://img.shields.io/badge/Status-Production%20Ready-brightgreen.svg)

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ­ Live2D æ¸²æŸ“å¼•æ“
- **Hiyori æ¨¡å‹æ”¯æŒ**: å®Œæ•´çš„ Live2D Cubism SDK é›†æˆ
- **å®æ—¶è¡¨æƒ…æ§åˆ¶**: åŸºäºæƒ…æ„Ÿæ ‡ç­¾çš„åŠ¨æ€è¡¨æƒ…åˆ‡æ¢ï¼ˆ18+ ç§è¡¨æƒ…ï¼‰
- **å‚æ•°åŒ–åŠ¨ç”»**: ç²¾ç¡®çš„å‚æ•°æ§åˆ¶å’Œå¹³æ»‘è¿‡æ¸¡
- **å‘¼å¸å’Œçœ¼éƒ¨é—ªçƒ**: è‡ªç„¶çš„ç”Ÿå‘½æ„ŸåŠ¨ç”»æ•ˆæœ
- **VBridger å”‡å½¢åŒæ­¥**: é«˜ç²¾åº¦çš„å˜´å‹åŒæ­¥

### ğŸ¤ æ™ºèƒ½è¯­éŸ³å¤„ç†
- **Whisper ASR**: é«˜ç²¾åº¦å¤šè¯­è¨€è¯­éŸ³è¯†åˆ«
- **å®æ—¶éŸ³é¢‘å¤„ç†**: PyAudio é©±åŠ¨çš„éŸ³é¢‘è¾“å…¥è¾“å‡º
- **VAD æ£€æµ‹**: æ™ºèƒ½è¯­éŸ³æ´»åŠ¨æ£€æµ‹
- **éŸ³é¢‘è®¾å¤‡ç®¡ç†**: è‡ªåŠ¨è®¾å¤‡æ£€æµ‹å’Œé…ç½®

### ğŸ—£ï¸ è‡ªç„¶è¯­éŸ³åˆæˆ
- **å¤šå¼•æ“ TTS**: æ”¯æŒå¤šç§ TTS å¼•æ“
- **æƒ…æ„Ÿè¯­éŸ³**: æ ¹æ®æƒ…æ„ŸçŠ¶æ€è°ƒæ•´è¯­éŸ³è¡¨ç°
- **å®æ—¶æ’­æ”¾**: ä½å»¶è¿ŸéŸ³é¢‘æ’­æ”¾ç³»ç»Ÿ

### ğŸ¤– å¯¹è¯ç®¡ç†ç³»ç»Ÿ
- **LLM é›†æˆ**: æ”¯æŒ OpenAIã€Anthropic ç­‰å¤šç§ API
- **æƒ…æ„Ÿè¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«å’Œè§£æå¯¹è¯ä¸­çš„æƒ…æ„Ÿæ ‡ç­¾
- **çŠ¶æ€ç®¡ç†**: å®Œæ•´çš„å¯¹è¯çŠ¶æ€æœºå®ç°
- **ä¸Šä¸‹æ–‡ç»´æŠ¤**: æ™ºèƒ½å¯¹è¯å†å²ç®¡ç†

### ğŸ“º ä¸“ä¸šæ¨æµç³»ç»Ÿ
- **OBS Studio é›†æˆ**: WebSocket æ§åˆ¶å’Œ Spout è¾“å‡º
- **è™šæ‹Ÿæ‘„åƒå¤´**: ç›´æ¥è¾“å‡ºåˆ°ç³»ç»Ÿè™šæ‹Ÿæ‘„åƒå¤´
- **å®æ—¶æ¸²æŸ“**: 60fps é«˜å¸§ç‡æ¸²æŸ“è¾“å‡º
- **å¤šå¹³å°æ”¯æŒ**: Windowsã€macOSã€Linux å…¼å®¹

### ğŸ¨ Hiyori æ¨¡å‹ä¸“é—¨ä¼˜åŒ–
- **å®Œæ•´é…ç½®ç³»ç»Ÿ**: YAML é…ç½®æ–‡ä»¶ç®¡ç†
- **è¡¨æƒ…æ˜ å°„**: è¯¦ç»†çš„æƒ…æ„Ÿè¡¨æƒ…é¢„è®¾
- **åŠ¨ä½œæ§åˆ¶**: æ™ºèƒ½åŠ¨ä½œé€‰æ‹©å’Œæ’­æ”¾
- **æ€§èƒ½ä¼˜åŒ–**: é’ˆå¯¹ Hiyori æ¨¡å‹çš„ä¸“é—¨ä¼˜åŒ–

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Python 3.9+**
- **ç³»ç»Ÿè¦æ±‚**: Windows 10/11, macOS 10.15+, Ubuntu 18.04+
- **ç¡¬ä»¶è¦æ±‚**: 
  - 4GB+ RAM
  - ç‹¬ç«‹æ˜¾å¡æ¨èï¼ˆæ”¯æŒ OpenGL 3.3+ï¼‰
  - éŸ³é¢‘è¾“å…¥/è¾“å‡ºè®¾å¤‡
- **ä¾èµ–è½¯ä»¶**:
  - FFmpeg
  - OBS Studioï¼ˆæ¨æµåŠŸèƒ½ï¼‰

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**:
```bash
git clone https://github.com/your-repo/parrot-engine.git
cd parrot-engine
```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**:
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate     # Windows
```

3. **å®‰è£…ä¾èµ–**:
```bash
# é¦–å…ˆå®‰è£…ç³»ç»Ÿä¾èµ– (macOS)
brew install portaudio

# ä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰Pythonä¾èµ–
pip install -r requirements.txt
```

> **æ³¨æ„**: å·²ä¿®å¤æ‰€æœ‰ä¾èµ–å†²çªé—®é¢˜ã€‚å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ `INSTALL_STATUS.md` äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

4. **é…ç½®ç³»ç»Ÿ**:
```bash
cp config/config.example.yaml config/config.yaml
# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œè®¾ç½® API å¯†é’¥ç­‰å‚æ•°
```

5. **é…ç½® Hiyori æ¨¡å‹**:
```bash
# Hiyori é…ç½®æ–‡ä»¶å·²é¢„è®¾ï¼Œå¯æ ¹æ®éœ€è¦è°ƒæ•´
cp config/hiyori_config.yaml config/hiyori_config.yaml
```

6. **è¿è¡Œç³»ç»Ÿ**:
```bash
python main.py
```

### å¿«é€Ÿæµ‹è¯•

è¿è¡Œé›†æˆæµ‹è¯•éªŒè¯ç³»ç»ŸåŠŸèƒ½ï¼š
```bash
python test_integration.py
```

è¿è¡Œæ€§èƒ½ä¼˜åŒ–åˆ†æï¼š
```bash
python optimize_performance.py
```

## ğŸ“ é¡¹ç›®æ¶æ„

```
parrot-engine/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/                 # æ ¸å¿ƒå¼•æ“
â”‚   â”‚   â””â”€â”€ avatar_engine.py  # ä¸»å¼•æ“ç±»
â”‚   â”œâ”€â”€ modules/              # åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ asr/              # è¯­éŸ³è¯†åˆ«
â”‚   â”‚   â”‚   â””â”€â”€ whisper_asr.py
â”‚   â”‚   â”œâ”€â”€ tts/              # æ–‡æœ¬è½¬è¯­éŸ³
â”‚   â”‚   â”‚   â””â”€â”€ tts_engine.py
â”‚   â”‚   â”œâ”€â”€ llm/              # å¤§è¯­è¨€æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ llm_client.py
â”‚   â”‚   â”œâ”€â”€ live2d/           # Live2D æ¸²æŸ“
â”‚   â”‚   â”‚   â”œâ”€â”€ live2d_manager.py
â”‚   â”‚   â”‚   â”œâ”€â”€ hiyori_config.py
â”‚   â”‚   â”‚   â””â”€â”€ Models/Hiyori/  # Hiyori æ¨¡å‹æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ audio/            # éŸ³é¢‘å¤„ç†
â”‚   â”‚       â””â”€â”€ audio_manager.py
â”‚   â”œâ”€â”€ rendering/            # æ¸²æŸ“å’Œæ¨æµ
â”‚   â”‚   â””â”€â”€ spout_streamer.py
â”‚   â”œâ”€â”€ ui/                   # ç”¨æˆ·ç•Œé¢
â”‚   â”‚   â””â”€â”€ control_panel.py
â”‚   â””â”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ config.py
â”‚       â””â”€â”€ event_bus.py
â”œâ”€â”€ config/                   # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ config.example.yaml
â”‚   â””â”€â”€ hiyori_config.yaml
â”œâ”€â”€ docs/                     # æ–‡æ¡£
â”‚   â””â”€â”€ architecture_analysis.md
â”œâ”€â”€ test_integration.py       # é›†æˆæµ‹è¯•
â”œâ”€â”€ optimize_performance.py   # æ€§èƒ½ä¼˜åŒ–
â””â”€â”€ main.py                  # ä¸»å…¥å£
```

## âš™ï¸ é…ç½®è¯´æ˜

### ä¸»é…ç½®æ–‡ä»¶ (`config/config.yaml`)

```yaml
# LLM è®¾ç½®
llm:
  provider: "openai"
  api_key: "your-api-key-here"
  model: "gpt-4"
  endpoint: "https://api.openai.com/v1"

# TTS è®¾ç½®
tts:
  engine: "default"
  voice: "zh-CN"
  speed: 1.0
  volume: 0.8

# ASR è®¾ç½®
asr:
  model: "base"
  language: "zh"
  vad_threshold: 0.5

# éŸ³é¢‘è®¾ç½®
audio:
  sample_rate: 16000
  buffer_size: 1024
  input_device: null
  output_device: null

# Live2D è®¾ç½®
live2d:
  model_path: "src/modules/live2d/Models/Hiyori"
  model_name: "Hiyori"
  width: 1080
  height: 1920

# æ¨æµè®¾ç½®
streaming:
  enable_obs: true
  obs_host: "localhost"
  obs_port: 4444
  obs_password: ""
  target_fps: 60
```

### Hiyori æ¨¡å‹é…ç½® (`config/hiyori_config.yaml`)

åŒ…å«è¯¦ç»†çš„è¡¨æƒ…æ˜ å°„ã€åŠ¨ä½œæ§åˆ¶ã€å‚æ•°èŒƒå›´ç­‰é…ç½®ã€‚æ”¯æŒï¼š

- **18+ ç§æƒ…æ„Ÿè¡¨æƒ…**: happy, excited, cool, smug, determined, embarrassed, shocked, thinking, suspicious, frustrated, sad, awkward, dismissive, adoring, laughing, passionate, sparkle, neutral
- **å‚æ•°åŒ–æ§åˆ¶**: å˜´éƒ¨ã€çœ¼éƒ¨ã€å¤´éƒ¨ã€çœ‰æ¯›ç­‰ç²¾ç¡®å‚æ•°æ§åˆ¶
- **åŠ¨ç”»æ•ˆæœ**: çœ¼éƒ¨é—ªçƒã€å‘¼å¸æ•ˆæœã€å¹³æ»‘è¿‡æ¸¡
- **æ€§èƒ½ä¼˜åŒ–**: FPS æ§åˆ¶ã€å‚æ•°å¹³æ»‘ã€å†…å­˜ä¼˜åŒ–

## ğŸ® ä½¿ç”¨è¯´æ˜

### åŸºæœ¬ä½¿ç”¨

1. **å¯åŠ¨ç³»ç»Ÿ**: è¿è¡Œ `python main.py`
2. **è¯­éŸ³äº¤äº’**: å¯¹ç€éº¦å…‹é£è¯´è¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å¹¶å›åº”
3. **è¡¨æƒ…æ§åˆ¶**: ç³»ç»Ÿä¼šæ ¹æ®å¯¹è¯å†…å®¹è‡ªåŠ¨åˆ‡æ¢è¡¨æƒ…
4. **æ¨æµè¾“å‡º**: åœ¨ OBS ä¸­æ·»åŠ  Spout æºæŸ¥çœ‹è™šæ‹Ÿæ•°å­—äºº

### é«˜çº§åŠŸèƒ½

#### æ‰‹åŠ¨æ§åˆ¶è¡¨æƒ…
```python
from src.core.avatar_engine import AvatarEngine

engine = AvatarEngine()
await engine.initialize()

# è®¾ç½®è¡¨æƒ…
await engine.live2d_manager.set_expression("happy")
await engine.live2d_manager.set_expression("thinking")
```

#### è‡ªå®šä¹‰é…ç½®
```python
from src.modules.live2d.hiyori_config import HiyoriConfig

config = HiyoriConfig()
config.load_config()

# ä¿®æ”¹è¡¨æƒ…å‚æ•°
config.update_expression("custom_happy", {
    "ParamMouthForm": 0.8,
    "ParamEyeLOpen": 1.0,
    "ParamEyeROpen": 1.0
})
config.save_config()
```

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°è¡¨æƒ…

1. åœ¨ `config/hiyori_config.yaml` ä¸­æ·»åŠ è¡¨æƒ…å®šä¹‰
2. é…ç½®ç›¸åº”çš„å‚æ•°å€¼
3. é‡æ–°åŠ è½½é…ç½®

### é›†æˆæ–°çš„ LLM

1. åœ¨ `src/modules/llm/` ä¸­åˆ›å»ºæ–°çš„å®¢æˆ·ç«¯ç±»
2. å®ç°ç»Ÿä¸€çš„æ¥å£
3. åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ç›¸åº”è®¾ç½®

### è‡ªå®šä¹‰ Live2D æ¨¡å‹

1. å°†æ¨¡å‹æ–‡ä»¶æ”¾å…¥ `src/modules/live2d/Models/`
2. åˆ›å»ºç›¸åº”çš„é…ç½®æ–‡ä»¶
3. æ›´æ–°æ¨¡å‹è·¯å¾„è®¾ç½®

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

ç³»ç»Ÿæä¾›äº†å®Œæ•´çš„æ€§èƒ½åˆ†æå’Œä¼˜åŒ–å·¥å…·ï¼š

```bash
# è¿è¡Œæ€§èƒ½åˆ†æ
python optimize_performance.py
```

ä¼˜åŒ–å»ºè®®ï¼š
- **å†…å­˜ä¼˜åŒ–**: å®šæœŸåƒåœ¾å›æ”¶ï¼Œç›‘æ§å†…å­˜ä½¿ç”¨
- **æ¸²æŸ“ä¼˜åŒ–**: æ ¹æ®éœ€æ±‚è°ƒæ•´ FPS å’Œåˆ†è¾¨ç‡
- **éŸ³é¢‘ä¼˜åŒ–**: åˆç†è®¾ç½®ç¼“å†²åŒºå¤§å°
- **ç½‘ç»œä¼˜åŒ–**: ä¼˜åŒ– LLM API è°ƒç”¨

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•
```bash
# é›†æˆæµ‹è¯•
python test_integration.py

# æ€§èƒ½æµ‹è¯•
python optimize_performance.py
```

### æµ‹è¯•è¦†ç›–
- âœ… é…ç½®åŠ è½½æµ‹è¯•
- âœ… å¼•æ“åˆå§‹åŒ–æµ‹è¯•
- âœ… Live2D æ¨¡å—æµ‹è¯•
- âœ… éŸ³é¢‘æ¨¡å—æµ‹è¯•
- âœ… æ¨æµæ¨¡å—æµ‹è¯•
- âœ… å®Œæ•´å·¥ä½œæµç¨‹æµ‹è¯•

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼

1. **Fork** æœ¬ä»“åº“
2. **åˆ›å»º** åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. **æäº¤** æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. **æ¨é€** åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. **æ‰“å¼€** Pull Request

### ä»£ç è§„èŒƒ
- éµå¾ª PEP 8 Python ä»£ç è§„èŒƒ
- æ·»åŠ é€‚å½“çš„æ³¨é‡Šå’Œæ–‡æ¡£å­—ç¬¦ä¸²
- ä¸ºæ–°åŠŸèƒ½ç¼–å†™æµ‹è¯•

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- **åŸç‰ˆé¡¹ç›®**: [handcrafted-persona-engine](https://github.com/fagenorn/handcrafted-persona-engine)
- **Live2D**: Live2D Cubism SDK
- **OpenAI**: Whisper ASR å’Œ GPT æ¨¡å‹
- **éŸ³é¢‘å¤„ç†**: PyAudio, librosa
- **å›¾å½¢æ¸²æŸ“**: OpenGL, PIL
- **Hiyori æ¨¡å‹**: Live2D å®˜æ–¹ç¤ºä¾‹æ¨¡å‹

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ [æ–‡æ¡£](docs/)
2. æäº¤ [Issue](https://github.com/your-repo/parrot-engine/issues)
3. åŠ å…¥è®¨è®ºåŒº

---

**è®©æˆ‘ä»¬ä¸€èµ·æ‰“é€ æ›´å¥½çš„è™šæ‹Ÿæ•°å­—äººä½“éªŒï¼** ğŸ­âœ¨ 